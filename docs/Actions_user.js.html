<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Actions/user.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Actions/user.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//get current user (me) from token in localstorage
export const ME_FROM_TOKEN = "ME_FROM_TOKEN";
export const ME_FROM_TOKEN_SUCCESS = "ME_FROM_TOKEN_SUCCESS";
export const ME_FROM_TOKEN_FAILURE = "ME_FROM_TOKEN_FAILURE";
export const RESET_TOKEN = "RESET_TOKEN";

//sign up user
export const SIGNUP_REQUEST = "SIGNUP_USER_REQUEST";
export const SIGNUP_SUCCESS = "SIGNUP_USER_SUCCESS";
export const SIGNUP_FAILURE = "SIGNUP_USER_FAILURE";
export const RESET_USER = "RESET_USER";

//sign in user
export const LOGIN_REQUEST = "LOGIN_REQUEST";
export const LOGIN_SUCCESS = "LOGIN_SUCCESS";
export const LOGIN_FAILURE = "LOGIN_FAILURE";

//validate email, if success, then load user and login
export const VALIDATE_EMAIL_REQUEST = "VALIDATE_EMAIL_REQUEST";
export const VALIDATE_EMAIL_SUCCESS = "VALIDATE_EMAIL_SUCCESS";
export const VALIDATE_EMAIL_FAILURE = "VALIDATE_EMAIL_FAILURE";

//called when email is updated in profile to update main user's email
export const UPDATE_USER_EMAIL = "UPDATE_USER_EMAIL";

//logout user
export const LOGOUT_REQUEST = "LOGOUT_REQUEST";
export const LOGOUT_SUCCESS = "LOGOUT_SUCCESS";

//endpoint constants for our API calls. Currently empty.
export const LOGIN_ENDPOINT = "";
export const SIGNUP_ENDPOINT = "";

/*
    Actions for the user reducer. A container will dispatch one of these actions upon the user
    interacting with the app. The sounds reducer will receive one of these actions and adjust the
    Redux state accordingly.
 */

/**
 * called when user logins in with a pair of credentials. Posts the credential data, and if it's authenticated on the server, returns a JWT
 */

export const loginUser = creds => dispatch => {
  let config = {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body: "username=${creds.username}&amp;password=${creds.password}"
  };

  dispatch(requestLogin(creds));

  return fetch(LOGIN_ENDPOINT, config)
    .then(response => response.json().then(user => ({ user, response })))
    .then(({ user, response }) => {
      if (!response.ok) {
        //there was a problem
        dispatch(loginError(user.message));
        return Promise.reject(user);
      } else {
        localStorage.setItem("id_token", user.id_token);
        //localStorage.setItem('id_token', user.access_token);
        dispatch(receiveLogin(user));
      }
    })
    .catch(err => console.log("Error: ", err));
};

/**
 * called when a user signs up with a set of credentials
 */

export const signUpUser = creds => dispatch => {
  //TODO: complete signup user action
  let config = {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body:
      "email=${creds.email}username=${creds.username}&amp;password=${creds.password}"
  };

  dispatch(requestSignup(creds));

  return fetch(SIGNUP_ENDPOINT, config)
    .then(response => response.json().then(user => ({ user, response })))
    .then(({ user, response }) => {
      if (!response.ok) {
        //there was a problem signing up
        dispatch(signupError(user.message));
        return Promise.reject(user);
      } else {
        localStorage.setItem("id_token", user.id_token);
        dispatch(receiveSignup(user));
      }
    })
    .catch(err => console.log("Error: ", err));
};

/**
 * called when a user clicks the 'logout' button on the navbar
 */

export const logoutUser = () => dispatch => {
  dispatch(requestLogout());
  localStorage.removeItem("id_token");
  localStorage.removeItem("access_token");
  dispatch(receiveLogout());
};

//the rest of the below actions are simple actions which simply are received by the user reducer and change the state
export const requestLogin = creds => ({
  type: LOGIN_REQUEST,
  isFetching: true,
  isAuthenticated: false,
  creds
});
export const requestLogout = () => ({
  type: LOGOUT_REQUEST,
  isFetching: true,
  isAuthenticated: true
});
export const requestSignup = () => ({
  type: SIGNUP_REQUEST,
  isFetching: true
});
export const receiveLogin = user => ({
  type: LOGIN_SUCCESS,
  isFetching: false,
  isAuthenticated: true,
  id_token: user.id_token
});
export const receiveLogout = () => ({
  type: LOGOUT_SUCCESS,
  isFetching: false,
  isAuthenticated: false
});
export const receiveSignup = user => ({
  type: SIGNUP_SUCCESS,
  isFetching: false,
  isAuthenticated: true,
  id_token: user.id_token
});
export const loginError = message => ({
  type: LOGIN_FAILURE,
  isFetching: false,
  isAuthenticated: false,
  message
});
export const signupError = message => ({
  type: SIGNUP_FAILURE,
  isFetching: false,
  isAuthenticated: false,
  message
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li><li><a href="App.html">App</a></li><li><a href="ItemInfo.html">ItemInfo</a></li><li><a href="LoopButton.html">LoopButton</a></li><li><a href="MuteButton.html">MuteButton</a></li><li><a href="Navbar.html">Navbar</a></li><li><a href="PlayButton.html">PlayButton</a></li><li><a href="Player.html">Player</a></li><li><a href="playPressed.html">playPressed</a></li><li><a href="Signin.html">Signin</a></li><li><a href="Upload.html">Upload</a></li></ul><h3>Global</h3><ul><li><a href="global.html#controls">controls</a></li><li><a href="global.html#fetchSounds">fetchSounds</a></li><li><a href="global.html#loginUser">loginUser</a></li><li><a href="global.html#logoutUser">logoutUser</a></li><li><a href="global.html#mapDispatchToProps">mapDispatchToProps</a></li><li><a href="global.html#mapStateToProps">mapStateToProps</a></li><li><a href="global.html#signUpUser">signUpUser</a></li><li><a href="global.html#sounds">sounds</a></li><li><a href="global.html#uploadSound">uploadSound</a></li><li><a href="global.html#user">user</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Feb 27 2018 23:52:20 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
